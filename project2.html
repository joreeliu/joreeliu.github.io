<!DOCTYPE html>
<html>
<head>   
  <title>Homeless Encampment in Each Police Precinct in NYC</title>
  <script src= "https://d3js.org/d3.v4.min.js"></script>
  <style>
  .line {
  fill: none;
  stroke: steelblue;
  stroke-width: 2px;
  }

  body {background-color: white;}
  h1   {color: black;
        font-family: verdana;
        font-size: 240%}
  h2   {color: black;
        font-family: verdana;
        font-size: 160%}
  h3   {color: black;
        font-family: verdana;
        font-size: 100%}
</style>

</head>
<h1>Homessless Emcampment <br>Complaints in NYC</h1>
<h2>Joree Liu</h2>
<h3> </h3>

<body>
    <script>
    

     var width = 760, 
      height = 400;
//////////////////////////////////////draw the map/////////////////////////////////
    var projection = d3.geoMercator()
    .scale(80000)
    //.center([107, 31]) 
    .translate([width/1.7, height/2]);

    var svg = d3.select("body").append("svg")
    .attr("width", width)
    .attr("height", height);



   d3.json("Police Precincts.geojson", function(data) {

    // after loading geojson, use d3.geo.centroid to find out 
    // where you need to center your map
    var center = d3.geoCentroid(data);

    projection.center(center);

    // now you can create new path function with 
    // correctly centered projection
    var path = d3.geoPath(projection);

    // and finally draw the actual polygons
    svg.selectAll("path")
      .data(data.features)
      .enter()
      .append("path")
      .attr("d", path)
      .attr("fill","black")
      .attr("class","area")
      .attr("d", path )  
      .on("mouseover",function(d,i){  
            
            d3.select(this)  
              .attr("fill","yellow");  
            })
      .on("mouseout",function(d,i){  
                d3.select("h3").text("Precinct ID:  " + d.properties.precinct);
                //console.log(d.properties.precinct)
                d3.select(this)  
                    .attr("fill","black")
                    .attr("class","incident hover");  
            });  
      d3.csv("311.csv",function(error,data){
     svg.selectAll("circle")
      .data(data)
      .enter()
      .append("circle")
      //.attr("cx",function(d){ return projection([d["Longitude"],d["Latitude"]])[0];})
      //.attr("cy",function(d){ return projection([d["Longitude"],d["Latitude"]])[1];})
      .attr("cx",function(d){
        return coords = projection([d.Longitude,d.Latitude])[0];
      })
      .attr("cy",function(d){
        return coords = projection([d.Longitude,d.Latitude])[1];
      })
      //.attr("cx",500)
      //.attr("cy",500)
      .attr("r",1)
      .style("fill","red")
      //.on("mouseover", function(d){

      //d3.select("h3").text(d["Location Type"]);
      //d3.select(this).attr("class","incident hover");
      
      //})
   



    
   });
    });
  
</script>
  <img src="p1.jpg" alt="Trulli" width="300" height="180" style="position: absolute;left: 10px; top: 280px;">
  <div id="mapwhole" width="1024" height="600" style="position: absolute;left: 10px;top:5px; ">
    <svg id="mapbox" width="1024" height="600">
    <rect id="outerBackground" width="1024" height="600" x="0" y="0" fill="lavenderblush" stroke="black" stroke-width="1"></rect>
    <svg id="map_area" width="822" height="558" x="101" y="31">
      <rect id="innerBackground" width="822" height="558" x="0" y="0" fill="white" stroke="#E50000" stroke-width="2" stroke-dasharray="3 2 3 1"></rect>
      <svg id="map" x="101" y="31">
        <script>
    

     var width = 760, 
      height = 400;
//////////////////////////////////////draw the map/////////////////////////////////
    var projection = d3.geoMercator()
    .scale(80000)
    //.center([107, 31]) 
    .translate([width/1.7, height/2]);

    var svg = d3.select("#map").append("svg")
    .attr("width", width)
    .attr("height", height);



   d3.json("Police Precincts.geojson", function(data) {

    // after loading geojson, use d3.geo.centroid to find out 
    // where you need to center your map
    var center = d3.geoCentroid(data);

    projection.center(center);

    // now you can create new path function with 
    // correctly centered projection
    var path = d3.geoPath(projection);

    // and finally draw the actual polygons
    svg.selectAll("path")
      .data(data.features)
      .enter()
      .append("path")
      .attr("d", path)
      .attr("fill","black")
      .attr("class","area")
      .attr("d", path )  
      .on("mouseover",function(d,i){  
            
            d3.select(this)  
              .attr("fill","yellow");  
            })
      .on("mouseout",function(d,i){  
                d3.select("h3").text("Precinct ID:  " + d.properties.precinct);
                //console.log(d.properties.precinct)
                d3.select(this)  
                    .attr("fill","black")
                    .attr("class","incident hover");  
            });  
      d3.csv("311.csv",function(error,data){
     svg.selectAll("circle")
      .data(data)
      .enter()
      .append("circle")
      //.attr("cx",function(d){ return projection([d["Longitude"],d["Latitude"]])[0];})
      //.attr("cy",function(d){ return projection([d["Longitude"],d["Latitude"]])[1];})
      .attr("cx",function(d){
        return coords = projection([d.Longitude,d.Latitude])[0];
      })
      .attr("cy",function(d){
        return coords = projection([d.Longitude,d.Latitude])[1];
      })
      //.attr("cx",500)
      //.attr("cy",500)
      .attr("r",1)
      .style("fill","red")
      //.on("mouseover", function(d){

      //d3.select("h3").text(d["Location Type"]);
      //d3.select(this).attr("class","incident hover");
      
      //})
   



    
   });
    });
  
</script>
        
      </svg>
    </svg>
  </svg>
  </div>
</body>
  <script>
    

     var width = 760, 
      height = 700;
//////////////////////////////////////draw the map/////////////////////////////////
    var projection = d3.geoMercator()
    .scale(80000)
    //.center([107, 31]) 
    .translate([width/1.7, height/2]);

    var svg = d3.select("body").append("svg")
    .attr("width", width)
    .attr("height", height);



   d3.json("Police Precincts.geojson", function(data) {

    // after loading geojson, use d3.geo.centroid to find out 
    // where you need to center your map
    var center = d3.geoCentroid(data);

    projection.center(center);

    // now you can create new path function with 
    // correctly centered projection
    var path = d3.geoPath(projection);

    // and finally draw the actual polygons
    svg.selectAll("path")
      .data(data.features)
      .enter()
      .append("path")
      .attr("d", path)
      .attr("fill","black")
      .attr("class","area")
      .attr("d", path )  
      .on("mouseover",function(d,i){  
            
            d3.select(this)  
              .attr("fill","yellow");  
            })
      .on("mouseout",function(d,i){  
                d3.select("h3").text("Precinct ID:  " + d.properties.precinct);
                //console.log(d.properties.precinct)
                d3.select(this)  
                    .attr("fill","black")
                    .attr("class","incident hover");  
            });  
      d3.csv("311.csv",function(error,data){
     svg.selectAll("circle")
      .data(data)
      .enter()
      .append("circle")
      //.attr("cx",function(d){ return projection([d["Longitude"],d["Latitude"]])[0];})
      //.attr("cy",function(d){ return projection([d["Longitude"],d["Latitude"]])[1];})
      .attr("cx",function(d){
        return coords = projection([d.Longitude,d.Latitude])[0];
      })
      .attr("cy",function(d){
        return coords = projection([d.Longitude,d.Latitude])[1];
      })
      //.attr("cx",500)
      //.attr("cy",500)
      .attr("r",1)
      .style("fill","red")
      //.on("mouseover", function(d){

      //d3.select("h3").text(d["Location Type"]);
      //d3.select(this).attr("class","incident hover");
      
      //})
   



    
   });
    });
  

   /*
    //////////////////////draw the time line chart////////////////////////  

// set the dimensions and margins of the graph
    var margin = {top: 10, right: 30, bottom: 30, left: 60},
    width = 260 - margin.left - margin.right,
    height = 200 - margin.top - margin.bottom;

// append the svg object to the body of the page
    var chart = d3.select("body")
    .append("svg")
    .attr("width", width + margin.left + margin.right)
    .attr("height", height + margin.top + margin.bottom)
    .append("g")
    .attr("transform",
          "translate(" + margin.left + "," + margin.top + ")");

//Read the data
    d3.csv("311.csv",

  // When reading the csv, I must format variables:
    function(d){
    return { date : d3.timeParse("%Y-%m-%d")(d["Create Date"]), value : d.value }
    },

  // Now I can use this dataset:
    function(data) {

    // Add X axis --> it is a date format
      var x = d3.scaleTime()
      .domain(d3.extent(data, function(d) { return d.date; }))
      .range([ 0, width ]);
    
    chart.append("g")
      .attr("transform", "translate(0," + height + ")")
      .call(d3.axisBottom(x));

    // Add Y axis
    var y = d3.scaleLinear()
      .domain([0, d3.max(data, function(d) { return +d.value; })])
      .range([ height, 0 ]);
    chart.append("g")
      .call(d3.axisLeft(y));

    // Add the line
    chart.append("path")
      .datum(data)
      .attr("fill", "none")
      .attr("stroke", "steelblue")
      .attr("stroke-width", 1.5)
      .attr("d", d3.line()
        .x(function(d) { return x(d.date) })
        .y(function(d) { return y(d.value) })
        )

      })

  
    
     /*svg.selectAll("circle")
      .data(data)
      .enter()
      .append("circle")
      .attr("cx",function(d){ return projection([d.Longitude,d.Latitude])[0];})
      .attr("cx",function(d){ return projection([d.Longitude,d.Latitude])[1];})
      .attr("r",5)
      .style("fill","red")
    console.log(projection([data["Longitude"],data["Latitude"]])[0])*/

  




  


    /*var svg = d3.select("body").append("svg")
        .attr("width",width)
        .attr("height",height)

    d3.json("china.json",function(data){

      var group = svg.selectAll("g")
          .data(data.features)
          .enter()
          .append("g")

      var projection = d3.geo.mercator().scale(1900).translate([width/2, height/2]);
      var path = d3.geo.path().projection(projection);

      var areas = group.append("path")
          .attr("d",path)
          .attr("class","area")
          .attr("fill","steelblue");
        })*/




    


  </script>
</body>

</html>